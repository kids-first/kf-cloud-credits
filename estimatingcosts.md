# Kids First Cloud Credit Program
## Estimating Cloud Computing Costs
_Note: While there are multiple cloud-based computing service providers, the Seven Bridges CAVATICA environment is built upon [Amazon Web Services (AWS)](https://aws.amazon.com/). The content of this page is specific to AWS and CAVATICA, most relevant to research on Kids First data._

### Principles of Cloud Computing Costs
High performance computing necessary for genome-scale analysis requires advanced computer infrastructure. By networking together a collection of servers and storage devices, researchers can utilize these machines to carry out the large scale calculations and computations required for genome alignment and variant calling. High performance computing incurs large upfront costs associated with purchasing equipment as well as ongoing costs associated with staff to maintain this environment and electricity to keep everything running.

Cloud-based computing allows access to this same infrastructure without owning and managing the machines themselves. Rather than purchase the computers themselves, users of cloud computing pay to work in this environment on an amount relative to their usage. Dozens of machines can be activated rapidly when an analysis is beginning - and then shut off just as quickly once the work is complete and they are no longer needed.

---
### Storage and Compute
Users of cloud computing broadly pay for two categories of usage: ___storage___ and ___compute___.

___Storage___ refers to keeping files stored in the cloud, analogous to storing files on the hard drive on your computer.

There are no storage costs for Kids First files on CAVATICA that are sent from the Kids First Portal. These include the harmonized genome alignments and called variants produced by our workflows that serve as starting points for your analysis. 

All other files in CAVATICA projects incur storage costs. These include files that users upload to the project and any output that is generated by user workflows. User-generated files associated with Kids First files (for example, an index file that is generated from a Kids First alignment file) fall under this category and will contribute toward storage costs.

Storing files in the cloud is billed on the size of the files and the length of time they are stored. Prices fluctuate, but are generally around 2 cents per gigabyte per month. The most current rate is availabe in [AWS's documentation, linked here](https://aws.amazon.com/s3/pricing/).

___Compute___ refers to using workflows to run computation on files. Within the CAVATICA environment, this could be running a Task of an App in order to process genome files to call variants. It could also refer to using the Interactive Analysis, such as the Data Cruncher to run R scripts and generate graphical output. 

Compute in the cloud is billed on the size of the computer being run and the length of time it is being used. Prices vary based on the scale of the job, with current rates available in [AWS's documentation, linked here](https://aws.amazon.com/ec2/pricing/on-demand/)

---
### Estimating Analyses

Lets begin with a rule of thumb example, which is helpful in getting a feel for analyses.   

Focusing on the major processes to run and a large enough machine, one can obtain a basic rule of thumb that could be used to estimate costs.  Choosing a single large-sized machine, such as a 16 vCPU (virtual CPU) machine with approximately 60 GB of RAM, we can see the savings between using a dedicated or an on-demand instance verusus a Spot instance.


**`Rule of Thumb Cost Estimator`**

| **Instance Type** | **Cost per Sample** | **1** | **10** | **100** | **1,000** | **10,000** | **100,000** | 
| ------------------- | --------------------- | ------- | -------- | --------- | ---------- | ----------- | ------------ |
| AWS 16 vCPU 60 GB On-Demand |  0.8956 dollars per hour | $ 0.90 | $ 9 | $90 | $ 896 | $8,956 | $ 89,560 | 
| AWS 16 vCPU 60 GB Spot      |  0.1614 dollars per hour | $ 0.16 | $ 2 | $16 | $ 161 | $1,614 | $ 16,140 |




---
### Choosing Workflows
Words Words Words


